<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>121683d3768a41da960291e9da3a91e7</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="8cdfadeb" class="cell markdown">
<h1 id="inm430-principles-of-data-science-notebook">INM430 Principles of
Data Science Notebook</h1>
<h2 id="sahan-chowdhury">Sahan Chowdhury</h2>
<h3
id="borough-level-carbon-accountability-a-data-driven-exploration-of-co2-emissions-in-london">Borough-Level
Carbon Accountability: A Data-Driven Exploration of CO2 Emissions in
London</h3>
<h4
id="this-notebook-contains-analysis-of-carbon-emisssions-in-killotoness-of-all-london-boroughs-in-the-domestic-industrial-and-commercial-and-transport-sector-specifically-looking-at-the-comparison-between-domestic-and-industrial-and-commercial-sector--the-comparison-between-domestic-and-transport-sector-the-impact-of-population-and-population-growth-on-co2-emissions-over-time-and-predictive-analysis-of-future-co2-emissions">This
notebook contains analysis of carbon emisssions in killotoness of all
London Boroughs in the Domestic, Industrial and Commercial and Transport
sector. Specifically looking at the comparison between Domestic and
Industrial and Commercial Sector , the comparison between Domestic and
Transport sector, the impact of population and population growth on CO2
emissions over time, and predictive analysis of future CO2
emissions</h4>
</div>
<div id="20785fe6" class="cell code" data-execution_count="905">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> pearsonr</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore warning messages to enhance code readability</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress all warnings to ensure a clean output</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div id="72abac6e" class="cell markdown">
<h6 id="data-preprocessing">Data Preprocessing</h6>
<p>In this section i will clean and process my dataset ready for
analysis</p>
</div>
<div id="ebdee5d2" class="cell code" data-execution_count="906">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dataset reference : https://data.london.gov.uk/dataset/leggi</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading the data from the CSV File &#39;emissions.csv&#39; and loading it into a pandas dataframe called data_emissions</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data_emissions <span class="op">=</span> pd.read_csv(<span class="st">&#39;emissions.csv&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Displaying the first couple rows and last couple rows of the dataset</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Where KtCO2e stands for kilotonnes of carbon dioxide equivalent&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>data_emissions</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Where KtCO2e stands for kilotonnes of carbon dioxide equivalent
</code></pre>
</div>
<div class="output execute_result" data-execution_count="906">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>Data_Year</th>
      <th>KtCO2e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>2017</td>
      <td>72.53736757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barnet</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>2017</td>
      <td>171.5542868</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bexley</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>2017</td>
      <td>103.10438</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brent</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>2017</td>
      <td>117.7367344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bromley</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>2017</td>
      <td>151.7814693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5035</th>
      <td>Waltham Forest</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>NaN</td>
      <td>929.465068</td>
    </tr>
    <tr>
      <th>5036</th>
      <td>Wandsworth</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>NaN</td>
      <td>1209.926514</td>
    </tr>
    <tr>
      <th>5037</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>NaN</td>
      <td>3212.433061</td>
    </tr>
    <tr>
      <th>5038</th>
      <td>Unapportioned</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>NaN</td>
      <td>67.88765717</td>
    </tr>
    <tr>
      <th>5039</th>
      <td>London</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>NaN</td>
      <td>43790.61155</td>
    </tr>
  </tbody>
</table>
<p>5040 rows × 6 columns</p>
</div>
</div>
</div>
<div id="18c617db" class="cell code" data-execution_count="907">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in the emissions dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_emissions.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="907">
<pre><code>Borough          0
LEGGI_Year       0
Sector           0
Fuel             0
Data_Year     1120
KtCO2e           2
dtype: int64</code></pre>
</div>
</div>
<div id="e1f7174c" class="cell markdown">
<p>From the dataframe table, i noticed that the Data_Year and LEGGI_Year
is identical, i only require the year of each row,furthermore the
Data_Year column has 1120 missing entries so i can remove Data_Year
column, as for the 2 missing entries for the KtCO2e column i would need
to inspect further</p>
</div>
<div id="3c35d8fc" class="cell code" data-execution_count="908">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We want see which rows have a missing value for KtCO2e</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data_emissions[data_emissions[<span class="st">&#39;KtCO2e&#39;</span>].isnull()]</span></code></pre></div>
<div class="output execute_result" data-execution_count="908">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>Data_Year</th>
      <th>KtCO2e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1048</th>
      <td>Unapportioned</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>2016</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1083</th>
      <td>Unapportioned</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Shipping</td>
      <td>2016</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="d57e32fa" class="cell markdown">
<p>We can see that the missing values are from Borough =
unapportioned,this will create ambiguity within my analysis hence i can
remove all rows which contain unapportioned, this will also remove the 2
missing values under KtCO2e from the dataframe. I will make these
changes on another dataframe</p>
</div>
<div id="5e5e1927" class="cell code" data-execution_count="909">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_emissions_copy <span class="op">=</span> data_emissions</span></code></pre></div>
</div>
<div id="d5053d67" class="cell code" data-execution_count="910">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for duplicate rows</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_emissions_copy[data_emissions_copy.duplicated()]</span></code></pre></div>
<div class="output execute_result" data-execution_count="910">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>Data_Year</th>
      <th>KtCO2e</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div id="34847226" class="cell code" data-execution_count="911">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert nessesary columsn to numeric</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">=</span> pd.to_numeric(data_emissions[<span class="st">&#39;LEGGI_Year&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>data_emissions[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">=</span> pd.to_numeric(data_emissions[<span class="st">&#39;KtCO2e&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span></code></pre></div>
</div>
<div id="d567f68e" class="cell code" data-execution_count="912">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a copy of the original dataset</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_emissions_copy <span class="op">=</span> data_emissions.copy()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#I will alter this copy of the main datafram and perform all data cleaning on this</span></span></code></pre></div>
</div>
<div id="7a6fd2a7" class="cell code" data-execution_count="913">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference = https://stackoverflow.com/questions/13411544/delete-a-column-from-a-pandas-dataframe</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the Data_Year Column, without altering the orignal datafram</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data_emissions_copy <span class="op">=</span> data_emissions_copy.drop(<span class="st">&#39;Data_Year&#39;</span>, axis <span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="8f3f45cd" class="cell code" data-execution_count="914">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reference: https://www.geeksforgeeks.org/how-to-drop-rows-that-contain-a-specific-string-in-pandas/</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Excluding rows with &#39;Unapportioned&#39; in the Borough Column</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>data_emissions_copy <span class="op">=</span> data_emissions_copy[data_emissions_copy[<span class="st">&quot;Borough&quot;</span>].<span class="bu">str</span>.contains(<span class="st">&quot;Unapportioned&quot;</span>)<span class="op">==</span><span class="va">False</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Display the modified dataframe</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data_emissions_copy</span></code></pre></div>
<div class="output execute_result" data-execution_count="914">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>KtCO2e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>72.537368</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barnet</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>171.554287</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bexley</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>103.104380</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brent</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>117.736734</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bromley</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>151.781469</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5034</th>
      <td>Tower Hamlets</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>2141.889857</td>
    </tr>
    <tr>
      <th>5035</th>
      <td>Waltham Forest</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>929.465068</td>
    </tr>
    <tr>
      <th>5036</th>
      <td>Wandsworth</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>1209.926514</td>
    </tr>
    <tr>
      <th>5037</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>3212.433061</td>
    </tr>
    <tr>
      <th>5039</th>
      <td>London</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>43790.611550</td>
    </tr>
  </tbody>
</table>
<p>4896 rows × 5 columns</p>
</div>
</div>
</div>
<div id="1bccb35a" class="cell markdown">
<p>In conjuction with this dataset i will also use a population
dataset</p>
</div>
<div id="cd1abaad" class="cell code" data-execution_count="915">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Now pre-processing the secondary dataset which will be used in conjuction with this dataset for the project</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Population Dataset</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>data_population <span class="op">=</span> pd.read_csv(<span class="st">&#39;housing-density-borough.csv&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#contains population details for every borough, including square kilometer and population per square kilometer</span></span></code></pre></div>
</div>
<div id="ab49b428" class="cell code" data-execution_count="916">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in the population dataset</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_population.isnull().<span class="bu">sum</span>()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>duplicates <span class="op">=</span> data_population.duplicated()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div id="66740bce" class="cell code" data-execution_count="917">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population.copy()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div id="3708b400" class="cell code" data-execution_count="918">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove specified columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="op">=</span> [<span class="st">&#39;Code&#39;</span>, <span class="st">&#39;Source&#39;</span>, <span class="st">&#39;Inland_Area _Hectares&#39;</span>, <span class="st">&#39;Total_Area_Hectares&#39;</span>, <span class="st">&#39;Population_per_hectare&#39;</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population_copy.drop(columns<span class="op">=</span>columns_to_remove)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove specified rows from the &#39;Name&#39; column</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>boroughs_to_remove <span class="op">=</span> [<span class="st">&#39;Inner London&#39;</span>, <span class="st">&#39;London&#39;</span>, <span class="st">&#39;Outer London&#39;</span>]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population_copy[<span class="op">~</span>data_population_copy[<span class="st">&#39;Name&#39;</span>].isin(boroughs_to_remove)]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows for the years 1999 to 2009</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>years_to_remove_1999_2009 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1999</span>, <span class="dv">2009</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population_copy[<span class="op">~</span>data_population[<span class="st">&#39;Year&#39;</span>].isin(years_to_remove_1999_2009)]</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows for the years 2040 to 2050</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>years_to_remove_2040_2050 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2040</span>, <span class="dv">2051</span>))</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population_copy[<span class="op">~</span>data_population_copy[<span class="st">&#39;Year&#39;</span>].isin(years_to_remove_2040_2050)]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>data_population_copy <span class="op">=</span> data_population_copy.rename(columns<span class="op">=</span>{<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;Year&#39;</span>: <span class="st">&#39;LEGGI_Year&#39;</span>})</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>data_population_copy</span></code></pre></div>
<div class="output execute_result" data-execution_count="918">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Population</th>
      <th>Square_Kilometres</th>
      <th>Population_per_square_kilometre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>City of London</td>
      <td>2009</td>
      <td>7472</td>
      <td>2.9</td>
      <td>2573.1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>City of London</td>
      <td>2010</td>
      <td>7338</td>
      <td>2.9</td>
      <td>2526.9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>City of London</td>
      <td>2011</td>
      <td>7412</td>
      <td>2.9</td>
      <td>2552.4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>City of London</td>
      <td>2012</td>
      <td>7204</td>
      <td>2.9</td>
      <td>2480.8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>City of London</td>
      <td>2013</td>
      <td>6848</td>
      <td>2.9</td>
      <td>2358.2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1752</th>
      <td>Greater London</td>
      <td>2035</td>
      <td>10396960</td>
      <td>1572.1</td>
      <td>6613.2</td>
    </tr>
    <tr>
      <th>1753</th>
      <td>Greater London</td>
      <td>2036</td>
      <td>10464787</td>
      <td>1572.1</td>
      <td>6656.4</td>
    </tr>
    <tr>
      <th>1754</th>
      <td>Greater London</td>
      <td>2037</td>
      <td>10531109</td>
      <td>1572.1</td>
      <td>6698.6</td>
    </tr>
    <tr>
      <th>1755</th>
      <td>Greater London</td>
      <td>2038</td>
      <td>10596112</td>
      <td>1572.1</td>
      <td>6739.9</td>
    </tr>
    <tr>
      <th>1756</th>
      <td>Greater London</td>
      <td>2039</td>
      <td>10659260</td>
      <td>1572.1</td>
      <td>6780.1</td>
    </tr>
  </tbody>
</table>
<p>1052 rows × 5 columns</p>
</div>
</div>
</div>
<div id="3353fd59" class="cell code" data-execution_count="919">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Population&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_population_copy[<span class="st">&#39;Borough&#39;</span>].unique())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Emissions&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_emissions_copy[<span class="st">&#39;Borough&#39;</span>].unique())</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace &#39;Richmond&#39; with &#39;Richmond upon Thames&#39; in both dataframes</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">=</span> data_emissions_copy[<span class="st">&#39;Borough&#39;</span>].replace(<span class="st">&#39;Richmond&#39;</span>, <span class="st">&#39;Richmond upon Thames&#39;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace &#39;Kingston&#39; with &#39;Kingston upon Thames&#39; in both dataframes</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">=</span> data_emissions_copy[<span class="st">&#39;Borough&#39;</span>].replace(<span class="st">&#39;Kingston&#39;</span>, <span class="st">&#39;Kingston upon Thames&#39;</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace &#39;Greater London&#39; with &#39;London&#39; in the population dataframe</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>data_population_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">=</span> data_population_copy[<span class="st">&#39;Borough&#39;</span>].replace(<span class="st">&#39;Greater London&#39;</span>, <span class="st">&#39;London&#39;</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>data_emissions_population <span class="op">=</span> pd.merge(data_emissions_copy, data_population_copy, on<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;LEGGI_Year&#39;</span>], how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Population
[&#39;City of London&#39; &#39;Barking and Dagenham&#39; &#39;Barnet&#39; &#39;Bexley&#39; &#39;Brent&#39;
 &#39;Bromley&#39; &#39;Camden&#39; &#39;Croydon&#39; &#39;Ealing&#39; &#39;Enfield&#39; &#39;Greenwich&#39; &#39;Hackney&#39;
 &#39;Hammersmith and Fulham&#39; &#39;Haringey&#39; &#39;Harrow&#39; &#39;Havering&#39; &#39;Hillingdon&#39;
 &#39;Hounslow&#39; &#39;Islington&#39; &#39;Kensington and Chelsea&#39; &#39;Kingston upon Thames&#39;
 &#39;Lambeth&#39; &#39;Lewisham&#39; &#39;Merton&#39; &#39;Newham&#39; &#39;Redbridge&#39; &#39;Richmond upon Thames&#39;
 &#39;Southwark&#39; &#39;Sutton&#39; &#39;Tower Hamlets&#39; &#39;Waltham Forest&#39; &#39;Wandsworth&#39;
 &#39;Westminster&#39; &#39;Greater London&#39;]
Emissions
[&#39;Barking and Dagenham&#39; &#39;Barnet&#39; &#39;Bexley&#39; &#39;Brent&#39; &#39;Bromley&#39; &#39;Camden&#39;
 &#39;City of London&#39; &#39;Croydon&#39; &#39;Ealing&#39; &#39;Enfield&#39; &#39;Greenwich&#39; &#39;Hackney&#39;
 &#39;Hammersmith and Fulham&#39; &#39;Haringey&#39; &#39;Harrow&#39; &#39;Havering&#39; &#39;Hillingdon&#39;
 &#39;Hounslow&#39; &#39;Islington&#39; &#39;Kensington and Chelsea&#39; &#39;Kingston&#39; &#39;Lambeth&#39;
 &#39;Lewisham&#39; &#39;Merton&#39; &#39;Newham&#39; &#39;Redbridge&#39; &#39;Richmond&#39; &#39;Southwark&#39; &#39;Sutton&#39;
 &#39;Tower Hamlets&#39; &#39;Waltham Forest&#39; &#39;Wandsworth&#39; &#39;Westminster&#39; &#39;London&#39;]
</code></pre>
</div>
</div>
<div id="2ce999d2" class="cell code" data-execution_count="920">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the &#39;Emissions_per_Capita&#39; column</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_emissions_population[<span class="st">&#39;Emissions_per_Capita&#39;</span>] <span class="op">=</span> data_emissions_population[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">/</span> data_emissions_population[<span class="st">&#39;Population&#39;</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrame to a CSV file</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>data_emissions_population.to_csv(<span class="st">&#39;data_emissions_population_.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>data_emissions_population</span></code></pre></div>
<div class="output execute_result" data-execution_count="920">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>KtCO2e</th>
      <th>Population</th>
      <th>Square_Kilometres</th>
      <th>Population_per_square_kilometre</th>
      <th>Emissions_per_Capita</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Electricity</td>
      <td>72.537368</td>
      <td>210513</td>
      <td>36.1</td>
      <td>5830.1</td>
      <td>0.000345</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Gas</td>
      <td>144.862242</td>
      <td>210513</td>
      <td>36.1</td>
      <td>5830.1</td>
      <td>0.000688</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Coal</td>
      <td>1.931094</td>
      <td>210513</td>
      <td>36.1</td>
      <td>5830.1</td>
      <td>0.000009</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Oil</td>
      <td>0.654757</td>
      <td>210513</td>
      <td>36.1</td>
      <td>5830.1</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barking and Dagenham</td>
      <td>2017</td>
      <td>Domestic</td>
      <td>Total</td>
      <td>219.985461</td>
      <td>210513</td>
      <td>36.1</td>
      <td>5830.1</td>
      <td>0.001045</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4873</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Railways diesel</td>
      <td>3.634070</td>
      <td>217187</td>
      <td>21.5</td>
      <td>10107.8</td>
      <td>0.000017</td>
    </tr>
    <tr>
      <th>4874</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Railways electric</td>
      <td>64.715012</td>
      <td>217187</td>
      <td>21.5</td>
      <td>10107.8</td>
      <td>0.000298</td>
    </tr>
    <tr>
      <th>4875</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>258.608611</td>
      <td>217187</td>
      <td>21.5</td>
      <td>10107.8</td>
      <td>0.001191</td>
    </tr>
    <tr>
      <th>4876</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Total</td>
      <td>327.135007</td>
      <td>217187</td>
      <td>21.5</td>
      <td>10107.8</td>
      <td>0.001506</td>
    </tr>
    <tr>
      <th>4877</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>3212.433061</td>
      <td>217187</td>
      <td>21.5</td>
      <td>10107.8</td>
      <td>0.014791</td>
    </tr>
  </tbody>
</table>
<p>4878 rows × 9 columns</p>
</div>
</div>
</div>
<div id="c9eda400" class="cell code" data-execution_count="921">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_emissions_population.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4878 entries, 0 to 4877
Data columns (total 9 columns):
 #   Column                           Non-Null Count  Dtype  
---  ------                           --------------  -----  
 0   Borough                          4878 non-null   object 
 1   LEGGI_Year                       4878 non-null   int64  
 2   Sector                           4878 non-null   object 
 3   Fuel                             4878 non-null   object 
 4   KtCO2e                           4878 non-null   float64
 5   Population                       4878 non-null   int64  
 6   Square_Kilometres                4878 non-null   float64
 7   Population_per_square_kilometre  4878 non-null   float64
 8   Emissions_per_Capita             4878 non-null   float64
dtypes: float64(4), int64(2), object(3)
memory usage: 343.1+ KB
</code></pre>
</div>
</div>
<div id="cad665d7" class="cell markdown">
<h5 id="interpreting-the-data">Interpreting the data</h5>
</div>
<div id="d2c32d43" class="cell code" data-execution_count="922">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying all Boroughs in the DataFrame</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>boroughs <span class="op">=</span> (data_emissions_population[<span class="st">&#39;Borough&#39;</span>].unique())</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Displaying number of Boroughs</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">##Reference : https://stackoverflow.com/questions/45759966/counting-unique-values-in-a-column-in-pandas-dataframe-like-in-qlik</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Number of Boroughs including London is&#39;</span>,data_emissions_copy[<span class="st">&#39;Borough&#39;</span>].nunique())</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>boroughs</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of Boroughs including London is 34
</code></pre>
</div>
<div class="output execute_result" data-execution_count="922">
<pre><code>array([&#39;Barking and Dagenham&#39;, &#39;Barnet&#39;, &#39;Bexley&#39;, &#39;Brent&#39;, &#39;Bromley&#39;,
       &#39;Camden&#39;, &#39;City of London&#39;, &#39;Croydon&#39;, &#39;Ealing&#39;, &#39;Enfield&#39;,
       &#39;Greenwich&#39;, &#39;Hackney&#39;, &#39;Hammersmith and Fulham&#39;, &#39;Haringey&#39;,
       &#39;Harrow&#39;, &#39;Havering&#39;, &#39;Hillingdon&#39;, &#39;Hounslow&#39;, &#39;Islington&#39;,
       &#39;Kensington and Chelsea&#39;, &#39;Kingston upon Thames&#39;, &#39;Lambeth&#39;,
       &#39;Lewisham&#39;, &#39;Merton&#39;, &#39;Newham&#39;, &#39;Redbridge&#39;,
       &#39;Richmond upon Thames&#39;, &#39;Southwark&#39;, &#39;Sutton&#39;, &#39;Tower Hamlets&#39;,
       &#39;Waltham Forest&#39;, &#39;Wandsworth&#39;, &#39;Westminster&#39;, &#39;London&#39;],
      dtype=object)</code></pre>
</div>
</div>
<div id="f6956f2f" class="cell markdown">
<p>I will also be using a shapefile of map of London and borough
boundaries i need to ensure that the borough names in the shapefile
match with that of my dataset</p>
</div>
<div id="d02a30af" class="cell code" data-execution_count="923">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print unique borough names in map_df</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shapefile</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>map_df <span class="op">=</span> gpd.read_file(<span class="st">&#39;statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&#39;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Printing the unique borough names in the shapefile</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Unique Borough Names in map_df:&quot;</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(map_df[<span class="st">&#39;NAME&#39;</span>].unique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Unique Borough Names in map_df:
[&#39;Kingston upon Thames&#39; &#39;Croydon&#39; &#39;Bromley&#39; &#39;Hounslow&#39; &#39;Ealing&#39; &#39;Havering&#39;
 &#39;Hillingdon&#39; &#39;Harrow&#39; &#39;Brent&#39; &#39;Barnet&#39; &#39;Lambeth&#39; &#39;Southwark&#39; &#39;Lewisham&#39;
 &#39;Greenwich&#39; &#39;Bexley&#39; &#39;Enfield&#39; &#39;Waltham Forest&#39; &#39;Redbridge&#39; &#39;Sutton&#39;
 &#39;Richmond upon Thames&#39; &#39;Merton&#39; &#39;Wandsworth&#39; &#39;Hammersmith and Fulham&#39;
 &#39;Kensington and Chelsea&#39; &#39;Westminster&#39; &#39;Camden&#39; &#39;Tower Hamlets&#39;
 &#39;Islington&#39; &#39;Hackney&#39; &#39;Haringey&#39; &#39;Newham&#39; &#39;Barking and Dagenham&#39;
 &#39;City of London&#39;]
</code></pre>
</div>
</div>
<div id="42f09099" class="cell markdown">
<p>The boroughs names which are different are 'Kingston upon Thames' and
'Richmond upon Thames', i will update these on my dataframe</p>
</div>
<div id="1d07049e" class="cell code" data-execution_count="924">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update specific borough names on our dataset to match that off the shapefile</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>data_emissions_population[<span class="st">&#39;Borough&#39;</span>] <span class="op">=</span> data_emissions_population[<span class="st">&#39;Borough&#39;</span>].replace({<span class="st">&#39;Kingston&#39;</span>: <span class="st">&#39;Kingston upon Thames&#39;</span>, <span class="st">&#39;Richmond&#39;</span>: <span class="st">&#39;Richmond upon Thames&#39;</span>})</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the changes</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Unique Borough Names in data_emissions_copy after update:&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_emissions_copy[<span class="st">&#39;Borough&#39;</span>].unique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Unique Borough Names in data_emissions_copy after update:
[&#39;Barking and Dagenham&#39; &#39;Barnet&#39; &#39;Bexley&#39; &#39;Brent&#39; &#39;Bromley&#39; &#39;Camden&#39;
 &#39;City of London&#39; &#39;Croydon&#39; &#39;Ealing&#39; &#39;Enfield&#39; &#39;Greenwich&#39; &#39;Hackney&#39;
 &#39;Hammersmith and Fulham&#39; &#39;Haringey&#39; &#39;Harrow&#39; &#39;Havering&#39; &#39;Hillingdon&#39;
 &#39;Hounslow&#39; &#39;Islington&#39; &#39;Kensington and Chelsea&#39; &#39;Kingston upon Thames&#39;
 &#39;Lambeth&#39; &#39;Lewisham&#39; &#39;Merton&#39; &#39;Newham&#39; &#39;Redbridge&#39; &#39;Richmond upon Thames&#39;
 &#39;Southwark&#39; &#39;Sutton&#39; &#39;Tower Hamlets&#39; &#39;Waltham Forest&#39; &#39;Wandsworth&#39;
 &#39;Westminster&#39; &#39;London&#39;]
</code></pre>
</div>
</div>
<div id="26edbcb5" class="cell code" data-execution_count="925">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the unique sectors and corresponding fuels in the DataFrame</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sector, fuel_types <span class="kw">in</span> data_emissions_copy.groupby(<span class="st">&#39;Sector&#39;</span>)[<span class="st">&#39;Fuel&#39;</span>]:</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>sector<span class="sc">}</span><span class="ss"> Sector: </span><span class="sc">{</span>fuel_types<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Domestic Sector: [&#39;Electricity&#39; &#39;Gas&#39; &#39;Coal&#39; &#39;Oil&#39; &#39;Total&#39;]
Industrial and Commercial Sector: [&#39;Electricity w/o rail&#39; &#39;Gas&#39; &#39;Coal&#39; &#39;Oil&#39; &#39;Waste and Renewables&#39; &#39;Total&#39;]
Total Sector: [&#39;Total&#39;]
Transport Sector: [&#39;Aviation&#39; &#39;Shipping&#39; &#39;Railways diesel&#39; &#39;Railways electric&#39;
 &#39;Road Transport&#39; &#39;Total&#39;]
</code></pre>
</div>
</div>
<div id="a278f611" class="cell markdown">
<h6 id="data-visualization">Data Visualization</h6>
</div>
<div id="9e9e12d8" class="cell markdown">
<p>Part 1 General data oversight</p>
</div>
<div id="62922f44" class="cell code" data-execution_count="926">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting a line graph showing trend of total sectors co2 emissions for London every year</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Borough = London, Fuel = Total, and specific sectors</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering data for London, specific sectors, Total fuel, and years between 2010 and 2017</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>filtered_data_london_sectors_2010_2017 <span class="op">=</span> data_emissions_population[ (data_emissions_population[<span class="st">&#39;Borough&#39;</span>] <span class="op">==</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>  (data_emissions_population[<span class="st">&#39;Sector&#39;</span>].isin([<span class="st">&#39;Transport&#39;</span>, <span class="st">&#39;Domestic&#39;</span>, <span class="st">&#39;Industrial and Commercial&#39;</span>])) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span><span class="st">&#39;Total&#39;</span>) <span class="op">&amp;</span> (data_emissions_population[<span class="st">&#39;LEGGI_Year&#39;</span>].between(<span class="dv">2010</span>, <span class="dv">2017</span>))]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference: https://stackoverflow.com/questions/20288842/matplotlib-iterate-subplot-axis-array-through-single-list</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting line graphs for the different sectors</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sector <span class="kw">in</span> [<span class="st">&#39;Transport&#39;</span>, <span class="st">&#39;Domestic&#39;</span>, <span class="st">&#39;Industrial and Commercial&#39;</span>]:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector], label<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>sector<span class="sc">}</span><span class="ss"> Emissions&#39;</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a second y-axis to plot population data</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;Population&#39;</span>, data<span class="op">=</span>filtered_data_london_sectors_2010_2017, label<span class="op">=</span><span class="st">&#39;Population&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;London Emissions and Population Over Time for Different Sectors&#39;</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;KtCO2e&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Population&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the legend</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlation only if lengths match</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>correlation, p_value <span class="op">=</span> pearsonr(filtered_data_london_sectors_2010_2017[<span class="st">&#39;KtCO2e&#39;</span>].dropna(), filtered_data_london_sectors_2010_2017[<span class="st">&#39;Population&#39;</span>].dropna())</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Pearson Correlation: </span><span class="sc">{</span>correlation<span class="sc">:.2f}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Pearson Correlation: -0.40, p-value: 0.0760
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/48f0777dfd076241ef54bedb5ba9716b8405a7b9.png" /></p>
</div>
</div>
<div id="5e06a2d5" class="cell markdown">
<p>Graph 1: Overall we can see that overtime the amount of KtCO2e has
gradually decreased for every sector. Domestic and Industrial and
commercial were far greater in 2010 than transport however end of 2017
we can see the gap between these sectors has closed down. Furthermore
both Domestic and industrial and commericial had a greater decrease,
however during 2011 it increased again. The transport sector seems to
have stay constant throughout, and we can see during 2016 industrial and
commercial fell below Domestic. Since this data gives a general overview
i now want to inspect further for every sector and find any extremes.
Since my dataset cant have outliers but extremes i want to find extremes
and do analysis on it.</p>
</div>
<div id="06b11f6a" class="cell markdown">
<p>Part 2 Detecting extremes</p>
</div>
<div id="272a4972" class="cell code" data-execution_count="927"
data-scrolled="false">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting for Domestic Sector (2010-2017) - All Boroughs</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the relevant years and exclude London borough and &#39;Total&#39; fuel type</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>filtered_data_domestic_boroughs_Nottotal <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>].isin([<span class="st">&#39;Electricity&#39;</span>, <span class="st">&#39;Gas&#39;</span>, <span class="st">&#39;Coal&#39;</span>, <span class="st">&#39;Oil&#39;</span>])) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Domestic&#39;</span>)]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>filtered_data_domestic_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">=</span> pd.to_numeric(filtered_data_domestic_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter plot for the &#39;Domestic&#39; sector</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">10</span>))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, data<span class="op">=</span>filtered_data_domestic_boroughs_Nottotal, palette<span class="op">=</span>{<span class="st">&#39;Electricity&#39;</span>: <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;Gas&#39;</span>: <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;Coal&#39;</span>: <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Oil&#39;</span>: <span class="st">&#39;red&#39;</span>})</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean values for each year</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>mean_line <span class="op">=</span> filtered_data_domestic_boroughs_Nottotal.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].mean().reset_index()</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot mean line for the entire graph</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>sns.lineplot(legend <span class="op">=</span> <span class="va">True</span>, x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>mean_line, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, label<span class="op">=</span><span class="st">&#39;Mean Line&#39;</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot for Domestic Sector (2010-2017) - All Boroughs&#39;</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;KtCO2e&#39;</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/7f661ce02fc77eda26592d6efc2fb9805964b07b.png" /></p>
</div>
</div>
<div id="54d2f6c2" class="cell markdown">
<p>From the scatter plot we can observe that majority of domestic CO2
emissions are very closely packed. Overall we see that the maximum value
has lowered over the years from 485 to 415 KTCO2e and the means is also
falling. Since we cannot have outliers as there is no specific trend
with the data i will pick out which plots are away from the pack and do
specific analysis. Another observation we can make is that majority of
the plots higher up comes from Gas, followed by electricity, hence we
can say that most fuel type which accounts for domestic carbon emission
in london boroughs is Gas and Electricity. The lower threshold of 7%
represents the 7th percentile of the z-scores distribution. This
threshold is set relatively low to identify data points that are
significantly below the mean. The upper threshold of 98% represents the
98th percentile of the z-scores distribution. This threshold is set
relatively high to identify data points that are significantly above the
mean. Choosing percentiles allows for a more flexible and data-driven
approach to identify outliers, capturing extreme values while minimizing
the impact of mild fluctuations in the data.Since we wanted to identify
the boroughs which do not follow the majority we used percentile to
obtain. On the lower end there was a variation of boroughs for fuel
types coal and oil, and City of london was the only borough which seemed
to have repeatedly very low emissions of coal throughout. However on the
other end of Barney, Bromley and Croydon whom seemed have the higest
domestic fuel consumption from 2010 to 2017 , and it was all Gas.</p>
</div>
<div id="e429f6dc" class="cell code" data-execution_count="928">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting for Domestic Sector (2010-2017) - All Boroughs</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the relevant years and exclude London borough and &#39;Total&#39; fuel type - setting conditions</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>].isin([<span class="st">&#39;Electricity w/o rail&#39;</span>, <span class="st">&#39;Gas&#39;</span>, <span class="st">&#39;Coal&#39;</span>, <span class="st">&#39;Oil&#39;</span>, <span class="st">&#39;Waste and Renewables&#39;</span>])) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>)]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">=</span> pd.to_numeric(filtered_data_industrial_commercial_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter plot for the &#39;Domestic&#39; sector</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">10</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, data<span class="op">=</span>filtered_data_industrial_commercial_boroughs_Nottotal)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean values for each year</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>mean_line <span class="op">=</span> filtered_data_industrial_commercial_boroughs_Nottotal.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].mean().reset_index()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot mean line for the entire graph</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>sns.lineplot(legend <span class="op">=</span> <span class="va">True</span>, x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>mean_line, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, label<span class="op">=</span><span class="st">&#39;Mean Line&#39;</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot title and axis labels</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot for Industrial &amp; Commercial Sector (2010-2017) - All Boroughs&#39;</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;KtCO2e&#39;</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/6e6e7e0af82c876b0d307bdcbcf099a85583ed19.png" /></p>
</div>
</div>
<div id="fe6d3f02" class="cell code" data-execution_count="929">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating z score to detect extremes</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference: https://www.geeksforgeeks.org/z-score-for-outlier-detection-python/</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate z-scores</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> z_score(data):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (data <span class="op">-</span> np.mean(data)) <span class="op">/</span> np.std(data)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for each data point within its group (year)</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal[<span class="st">&#39;Z_Score&#39;</span>] <span class="op">=</span> filtered_data_industrial_commercial_boroughs_Nottotal.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].transform(z_score)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a threshold for z-score to identify outliers</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>z_score_threshold <span class="op">=</span> <span class="dv">3</span>  </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers based on z-score</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Extremes for Industrial and Commercial Sector:&quot;</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>outliers_industrial_commercial <span class="op">=</span> (filtered_data_industrial_commercial_boroughs_Nottotal[np.<span class="bu">abs</span>(filtered_data_industrial_commercial_boroughs_Nottotal[<span class="st">&#39;Z_Score&#39;</span>]) <span class="op">&gt;</span> z_score_threshold])</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>outliers_industrial_commercial</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print or analyze the outlier data</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Extremes for Industrial and Commercial Sector:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="929">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>KtCO2e</th>
      <th>Z_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>181</th>
      <td>City of London</td>
      <td>2017</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>562.696025</td>
      <td>4.156748</td>
    </tr>
    <tr>
      <th>204</th>
      <td>Tower Hamlets</td>
      <td>2017</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>595.265801</td>
      <td>4.431665</td>
    </tr>
    <tr>
      <th>207</th>
      <td>Westminster</td>
      <td>2017</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>864.793818</td>
      <td>6.706713</td>
    </tr>
    <tr>
      <th>242</th>
      <td>Westminster</td>
      <td>2017</td>
      <td>Industrial and Commercial</td>
      <td>Gas</td>
      <td>494.822970</td>
      <td>3.583841</td>
    </tr>
    <tr>
      <th>811</th>
      <td>City of London</td>
      <td>2016</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>660.330347</td>
      <td>4.486347</td>
    </tr>
    <tr>
      <th>834</th>
      <td>Tower Hamlets</td>
      <td>2016</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>684.601023</td>
      <td>4.672134</td>
    </tr>
    <tr>
      <th>837</th>
      <td>Westminster</td>
      <td>2016</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>969.152924</td>
      <td>6.850320</td>
    </tr>
    <tr>
      <th>1441</th>
      <td>City of London</td>
      <td>2015</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>839.742224</td>
      <td>4.831071</td>
    </tr>
    <tr>
      <th>1464</th>
      <td>Tower Hamlets</td>
      <td>2015</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>832.361598</td>
      <td>4.783963</td>
    </tr>
    <tr>
      <th>1467</th>
      <td>Westminster</td>
      <td>2015</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1197.811216</td>
      <td>7.116504</td>
    </tr>
    <tr>
      <th>2071</th>
      <td>City of London</td>
      <td>2014</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>912.075197</td>
      <td>4.254512</td>
    </tr>
    <tr>
      <th>2094</th>
      <td>Tower Hamlets</td>
      <td>2014</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1093.616797</td>
      <td>5.202183</td>
    </tr>
    <tr>
      <th>2097</th>
      <td>Westminster</td>
      <td>2014</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1500.096514</td>
      <td>7.324061</td>
    </tr>
    <tr>
      <th>2701</th>
      <td>City of London</td>
      <td>2013</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1184.064963</td>
      <td>5.005738</td>
    </tr>
    <tr>
      <th>2724</th>
      <td>Tower Hamlets</td>
      <td>2013</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1158.908821</td>
      <td>4.889055</td>
    </tr>
    <tr>
      <th>2727</th>
      <td>Westminster</td>
      <td>2013</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1651.911933</td>
      <td>7.175795</td>
    </tr>
    <tr>
      <th>3331</th>
      <td>City of London</td>
      <td>2012</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1192.370394</td>
      <td>4.956002</td>
    </tr>
    <tr>
      <th>3354</th>
      <td>Tower Hamlets</td>
      <td>2012</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1293.683110</td>
      <td>5.417794</td>
    </tr>
    <tr>
      <th>3357</th>
      <td>Westminster</td>
      <td>2012</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1667.507353</td>
      <td>7.121714</td>
    </tr>
    <tr>
      <th>3961</th>
      <td>City of London</td>
      <td>2011</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1139.671720</td>
      <td>5.053522</td>
    </tr>
    <tr>
      <th>3984</th>
      <td>Tower Hamlets</td>
      <td>2011</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1106.843914</td>
      <td>4.894136</td>
    </tr>
    <tr>
      <th>3987</th>
      <td>Westminster</td>
      <td>2011</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1605.052862</td>
      <td>7.313044</td>
    </tr>
    <tr>
      <th>4591</th>
      <td>City of London</td>
      <td>2010</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1374.345398</td>
      <td>5.257806</td>
    </tr>
    <tr>
      <th>4614</th>
      <td>Tower Hamlets</td>
      <td>2010</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1402.830505</td>
      <td>5.376679</td>
    </tr>
    <tr>
      <th>4617</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Industrial and Commercial</td>
      <td>Electricity w/o rail</td>
      <td>1798.474398</td>
      <td>7.027769</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="8a97479e" class="cell markdown">
<p>From this plot we observe that for the industrial and commericial
sector, majority of the points are blue suggesting the higest fuel
consumption in this sector is Electricity w/o rail. Majority of the
plots lie between 0 and 750 KTCO2e. The maximum value has significantly
dropped from 1798 KTCO2e in 2010 to 864 KTCO2e in 2010. The mean has
also decreased. When we use z score to calculate outliers we see
westminister, towerhamlets and city of london dominate the timestamp
with electricity w/o rail, altough there has been a huge decrease since
2010, these 3 borough are still leading CO2 emissions for the industrial
and commericial sector in 2017</p>
</div>
<div id="bcbdaa89" class="cell code" data-execution_count="930">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting for Transport Sector (2010-2017) - All Boroughs</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the relevant years and exclude London borough and &#39;Total&#39; fuel type</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal <span class="op">=</span> data_emissions_copy[    (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>].isin([<span class="st">&#39;Aviation&#39;</span>, <span class="st">&#39;Shipping&#39;</span>, <span class="st">&#39;Railways diesel&#39;</span>, <span class="st">&#39;Railways electric&#39;</span>, <span class="st">&#39;Road Transport&#39;</span>])) <span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>)]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">=</span> pd.to_numeric(filtered_data_transport_boroughs_Nottotal[<span class="st">&#39;KtCO2e&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter plot for the &#39;Domestic&#39; sector</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">10</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, data<span class="op">=</span>filtered_data_transport_boroughs_Nottotal)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean values for each year</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>mean_line <span class="op">=</span> filtered_data_transport_boroughs_Nottotal.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].mean().reset_index()</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot mean line for the entire graph</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>sns.lineplot(legend <span class="op">=</span> <span class="va">True</span>, x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>mean_line, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, label<span class="op">=</span><span class="st">&#39;Mean Line&#39;</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot title and axis labels</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot for Transport Sector (2010-2017) - All Boroughs&#39;</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;KtCO2e&#39;</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/ab060ab5801f36705e44644e9aa87d93b7d3b320.png" /></p>
</div>
</div>
<div id="29648ef2" class="cell code" data-execution_count="931">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference: https://www.geeksforgeeks.org/z-score-for-outlier-detection-python/</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate z-scores</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> z_score(data):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (data <span class="op">-</span> np.mean(data)) <span class="op">/</span> np.std(data)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for each data point within its group (year)</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal[<span class="st">&#39;Z_Score&#39;</span>] <span class="op">=</span> filtered_data_transport_boroughs_Nottotal.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].transform(z_score)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a threshold for z-score to identify outliers</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>z_score_threshold <span class="op">=</span> <span class="dv">3</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>outliers_transport <span class="op">=</span> filtered_data_transport_boroughs_Nottotal[np.<span class="bu">abs</span>(filtered_data_transport_boroughs_Nottotal[<span class="st">&#39;Z_Score&#39;</span>]) <span class="op">&gt;</span> z_score_threshold]</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>outliers_transport</span></code></pre></div>
<div class="output execute_result" data-execution_count="931">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>KtCO2e</th>
      <th>Z_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>401</th>
      <td>Hillingdon</td>
      <td>2017</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>737.184352</td>
      <td>6.952556</td>
    </tr>
    <tr>
      <th>526</th>
      <td>Barnet</td>
      <td>2017</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>391.447763</td>
      <td>3.464719</td>
    </tr>
    <tr>
      <th>534</th>
      <td>Enfield</td>
      <td>2017</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>356.818276</td>
      <td>3.115372</td>
    </tr>
    <tr>
      <th>541</th>
      <td>Hillingdon</td>
      <td>2017</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>395.341681</td>
      <td>3.504001</td>
    </tr>
    <tr>
      <th>1031</th>
      <td>Hillingdon</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>775.528162</td>
      <td>7.025809</td>
    </tr>
    <tr>
      <th>1156</th>
      <td>Barnet</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>394.905080</td>
      <td>3.338701</td>
    </tr>
    <tr>
      <th>1164</th>
      <td>Enfield</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>364.302792</td>
      <td>3.042256</td>
    </tr>
    <tr>
      <th>1171</th>
      <td>Hillingdon</td>
      <td>2016</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>416.970145</td>
      <td>3.552446</td>
    </tr>
    <tr>
      <th>1661</th>
      <td>Hillingdon</td>
      <td>2015</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>676.695013</td>
      <td>6.419062</td>
    </tr>
    <tr>
      <th>1786</th>
      <td>Barnet</td>
      <td>2015</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>381.642066</td>
      <td>3.397251</td>
    </tr>
    <tr>
      <th>1794</th>
      <td>Enfield</td>
      <td>2015</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>357.794406</td>
      <td>3.153013</td>
    </tr>
    <tr>
      <th>1800</th>
      <td>Havering</td>
      <td>2015</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>344.898387</td>
      <td>3.020937</td>
    </tr>
    <tr>
      <th>1801</th>
      <td>Hillingdon</td>
      <td>2015</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>402.714136</td>
      <td>3.613063</td>
    </tr>
    <tr>
      <th>2291</th>
      <td>Hillingdon</td>
      <td>2014</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>674.745207</td>
      <td>6.248054</td>
    </tr>
    <tr>
      <th>2416</th>
      <td>Barnet</td>
      <td>2014</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>394.127266</td>
      <td>3.434027</td>
    </tr>
    <tr>
      <th>2424</th>
      <td>Enfield</td>
      <td>2014</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>365.972318</td>
      <td>3.151690</td>
    </tr>
    <tr>
      <th>2430</th>
      <td>Havering</td>
      <td>2014</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>354.149936</td>
      <td>3.033135</td>
    </tr>
    <tr>
      <th>2431</th>
      <td>Hillingdon</td>
      <td>2014</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>422.990530</td>
      <td>3.723467</td>
    </tr>
    <tr>
      <th>2921</th>
      <td>Hillingdon</td>
      <td>2013</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>720.341329</td>
      <td>6.807738</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>Barnet</td>
      <td>2013</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>373.182775</td>
      <td>3.269971</td>
    </tr>
    <tr>
      <th>3054</th>
      <td>Enfield</td>
      <td>2013</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>366.327486</td>
      <td>3.200111</td>
    </tr>
    <tr>
      <th>3061</th>
      <td>Hillingdon</td>
      <td>2013</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>392.334640</td>
      <td>3.465141</td>
    </tr>
    <tr>
      <th>3551</th>
      <td>Hillingdon</td>
      <td>2012</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>650.824228</td>
      <td>6.273710</td>
    </tr>
    <tr>
      <th>3676</th>
      <td>Barnet</td>
      <td>2012</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>374.219715</td>
      <td>3.375852</td>
    </tr>
    <tr>
      <th>3684</th>
      <td>Enfield</td>
      <td>2012</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>362.427831</td>
      <td>3.252314</td>
    </tr>
    <tr>
      <th>3691</th>
      <td>Hillingdon</td>
      <td>2012</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>388.574252</td>
      <td>3.526238</td>
    </tr>
    <tr>
      <th>4181</th>
      <td>Hillingdon</td>
      <td>2011</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>650.824228</td>
      <td>6.273710</td>
    </tr>
    <tr>
      <th>4306</th>
      <td>Barnet</td>
      <td>2011</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>374.219715</td>
      <td>3.375852</td>
    </tr>
    <tr>
      <th>4314</th>
      <td>Enfield</td>
      <td>2011</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>362.427831</td>
      <td>3.252314</td>
    </tr>
    <tr>
      <th>4321</th>
      <td>Hillingdon</td>
      <td>2011</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>388.574252</td>
      <td>3.526238</td>
    </tr>
    <tr>
      <th>4811</th>
      <td>Hillingdon</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Aviation</td>
      <td>650.824228</td>
      <td>6.273710</td>
    </tr>
    <tr>
      <th>4936</th>
      <td>Barnet</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>374.219715</td>
      <td>3.375852</td>
    </tr>
    <tr>
      <th>4944</th>
      <td>Enfield</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>362.427831</td>
      <td>3.252314</td>
    </tr>
    <tr>
      <th>4951</th>
      <td>Hillingdon</td>
      <td>2010</td>
      <td>Transport</td>
      <td>Road Transport</td>
      <td>388.574252</td>
      <td>3.526238</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="fd2c559a" class="cell markdown">
<p>From the transport scatter plot we observe that most values lie
within 0 - 450 KTCO2e, where majority of the plots are from Road
Transport. However Aviation is further dispersed from the rest of the
plot for every year and is much higher. In fact the Maxmimum KTCO2E
level has increased since 2010 from 650 to 730 KTCO2e, the mean has only
slighly dropped in the 7 year period. When we used outlier detection
using Z score. The 3 Clear Boroughs that emitting the most CO2 are
Hillingdon, Enfield &amp; Barnet, and is topped by Aviation from the
Borough of Hillingdon, with a substancially higher Z score. This is due
to the fact of Heathrow Airport</p>
</div>
<div id="da93f62a" class="cell code" data-execution_count="932">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting for Total Sector (2010-2017) - All Boroughs</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the relevant years and exclude London borough and &#39;Total&#39; fuel type</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>filtered_data_total_boroughs_total <span class="op">=</span> data_emissions_copy[    (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>)<span class="op">&amp;</span>(data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>filtered_data_total_boroughs_total[<span class="st">&#39;KtCO2e&#39;</span>] <span class="op">=</span> pd.to_numeric(filtered_data_total_boroughs_total[<span class="st">&#39;KtCO2e&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter plot for the &#39;Domestic&#39; sector</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">10</span>))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, data<span class="op">=</span>filtered_data_total_boroughs_total)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean values for each year</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>mean_line <span class="op">=</span> filtered_data_total_boroughs_total.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].mean().reset_index()</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot mean line for the entire graph</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>mean_line, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, label<span class="op">=</span><span class="st">&#39;Mean Line&#39;</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot title and axis labels</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot for Total Sector (2010-2017) - All Boroughs&#39;</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;KtCO2e&#39;</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/fe80549588f68d0efcb8bb77140512efd65c29d5.png" /></p>
</div>
</div>
<div id="ece8527d" class="cell code" data-execution_count="933">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate z-scores</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> z_score(data):</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (data <span class="op">-</span> np.mean(data)) <span class="op">/</span> np.std(data)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for each data point within its group (year) for the Total sector</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>filtered_data_total_boroughs_total[<span class="st">&#39;Z_Score&#39;</span>] <span class="op">=</span> filtered_data_total_boroughs_total.groupby(<span class="st">&#39;LEGGI_Year&#39;</span>)[<span class="st">&#39;KtCO2e&#39;</span>].transform(z_score)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a threshold for z-score to identify outliers</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>z_score_threshold_total <span class="op">=</span> <span class="fl">1.5</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers based on z-score for the Total sector</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>outliers_total <span class="op">=</span> filtered_data_total_boroughs_total[np.<span class="bu">abs</span>(filtered_data_total_boroughs_total[<span class="st">&#39;Z_Score&#39;</span>]) <span class="op">&gt;</span> z_score_threshold_total]</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>outliers_total</span></code></pre></div>
<div class="output execute_result" data-execution_count="933">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Borough</th>
      <th>LEGGI_Year</th>
      <th>Sector</th>
      <th>Fuel</th>
      <th>KtCO2e</th>
      <th>Z_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>611</th>
      <td>Hillingdon</td>
      <td>2017</td>
      <td>Total</td>
      <td>Total</td>
      <td>2097.508945</td>
      <td>3.390011</td>
    </tr>
    <tr>
      <th>627</th>
      <td>Westminster</td>
      <td>2017</td>
      <td>Total</td>
      <td>Total</td>
      <td>1984.283036</td>
      <td>3.064484</td>
    </tr>
    <tr>
      <th>1241</th>
      <td>Hillingdon</td>
      <td>2016</td>
      <td>Total</td>
      <td>Total</td>
      <td>2170.464015</td>
      <td>3.358993</td>
    </tr>
    <tr>
      <th>1257</th>
      <td>Westminster</td>
      <td>2016</td>
      <td>Total</td>
      <td>Total</td>
      <td>2071.191608</td>
      <td>3.085824</td>
    </tr>
    <tr>
      <th>1871</th>
      <td>Hillingdon</td>
      <td>2015</td>
      <td>Total</td>
      <td>Total</td>
      <td>2165.514599</td>
      <td>2.897518</td>
    </tr>
    <tr>
      <th>1887</th>
      <td>Westminster</td>
      <td>2015</td>
      <td>Total</td>
      <td>Total</td>
      <td>2375.198732</td>
      <td>3.433969</td>
    </tr>
    <tr>
      <th>2501</th>
      <td>Hillingdon</td>
      <td>2014</td>
      <td>Total</td>
      <td>Total</td>
      <td>2438.154066</td>
      <td>2.855494</td>
    </tr>
    <tr>
      <th>2517</th>
      <td>Westminster</td>
      <td>2014</td>
      <td>Total</td>
      <td>Total</td>
      <td>2708.731602</td>
      <td>3.454921</td>
    </tr>
    <tr>
      <th>3131</th>
      <td>Hillingdon</td>
      <td>2013</td>
      <td>Total</td>
      <td>Total</td>
      <td>2629.229908</td>
      <td>2.770695</td>
    </tr>
    <tr>
      <th>3147</th>
      <td>Westminster</td>
      <td>2013</td>
      <td>Total</td>
      <td>Total</td>
      <td>3043.784452</td>
      <td>3.596099</td>
    </tr>
    <tr>
      <th>3761</th>
      <td>Hillingdon</td>
      <td>2012</td>
      <td>Total</td>
      <td>Total</td>
      <td>2442.964832</td>
      <td>2.494482</td>
    </tr>
    <tr>
      <th>3774</th>
      <td>Tower Hamlets</td>
      <td>2012</td>
      <td>Total</td>
      <td>Total</td>
      <td>2003.844633</td>
      <td>1.588494</td>
    </tr>
    <tr>
      <th>3777</th>
      <td>Westminster</td>
      <td>2012</td>
      <td>Total</td>
      <td>Total</td>
      <td>2989.303775</td>
      <td>3.621681</td>
    </tr>
    <tr>
      <th>4391</th>
      <td>Hillingdon</td>
      <td>2011</td>
      <td>Total</td>
      <td>Total</td>
      <td>2366.563002</td>
      <td>2.578812</td>
    </tr>
    <tr>
      <th>4407</th>
      <td>Westminster</td>
      <td>2011</td>
      <td>Total</td>
      <td>Total</td>
      <td>2854.747754</td>
      <td>3.640641</td>
    </tr>
    <tr>
      <th>5021</th>
      <td>Hillingdon</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>2609.261706</td>
      <td>2.478077</td>
    </tr>
    <tr>
      <th>5034</th>
      <td>Tower Hamlets</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>2141.889857</td>
      <td>1.576297</td>
    </tr>
    <tr>
      <th>5037</th>
      <td>Westminster</td>
      <td>2010</td>
      <td>Total</td>
      <td>Total</td>
      <td>3212.433061</td>
      <td>3.641878</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="29a26152" class="cell markdown">
<p>The total sector gives an overview of all 32 Boroughs. The trend from
2010 to 2017 is that we can see total co2 emission from all sectors is
decreasing graduually and most boroughs have very close in terms of
total co2 emissions in 2017. The Boroughs which seem to have the highest
total emissions are Westminister, Tower Hamlets and Hillingdon</p>
</div>
<div id="fc6c33b1" class="cell markdown">
<p>Part 3 Fuel type contribution</p>
</div>
<div id="d701f08d" class="cell markdown">
<p>3.1 Domestic Sector</p>
</div>
<div id="2cd5f0b5" class="cell code" data-execution_count="934">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Looking at the trend between 2010 and 2017 for domestic sector </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010 and 2017</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>filtered_data_domestic_boroughs_Nottotal_2010_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Domestic&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set y-axis to logarithmic scale</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference style order</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference hue</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, style<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, style_order<span class="op">=</span>[<span class="dv">2010</span>, <span class="dv">2017</span>], data<span class="op">=</span>filtered_data_domestic_boroughs_Nottotal_2010_2017)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot; Fuel Type Contribution to Total KtCO2e in Domestic Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Total KtCO2e)&quot;</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better visibilitysince labels overlap</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/7d819b30ceffa9ee5a9d8b29ad2771e60ba47b81.png" /></p>
</div>
</div>
<div id="6dd1c15d" class="cell code" data-execution_count="935">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Looking at the trend between 2010 and 2017 for domestic sector </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010 and 2017</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>filtered_data_domestic_boroughs_Nottotal_2010_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Domestic&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set y-axis to logarithmic scale</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference style order</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference hue</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.lineplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, style<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, style_order<span class="op">=</span>[<span class="dv">2010</span>, <span class="dv">2017</span>], data<span class="op">=</span>filtered_data_domestic_boroughs_Nottotal_2010_2017)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">&#39;log&#39;</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot; Fuel Type Contribution to Total KtCO2e in Domestic Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Total KtCO2e)&quot;</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better visibility</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/be3472e9ed9797a34855f93734c62ee65e68bb9a.png" /></p>
</div>
</div>
<div id="9c222593" class="cell markdown">
<p>The General trend is that total fuel contibutions have dropped since
2010, we can look at correlation to assess the correlation between
each</p>
</div>
<div id="82d226dc" class="cell code" data-execution_count="936">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#*</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation Matrix</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference: https://github.com/vighnesh32/Principles-of-Data-Science-Project/blob/main/project.ipynb</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>pivot_domestic_2010 <span class="op">=</span> filtered_data_domestic_boroughs_Nottotal_2010.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame to have fuel types as columns for 2017</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>pivot_domestic_2017 <span class="op">=</span> filtered_data_domestic_boroughs_Nottotal_2017.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the two DataFrames along a new axis (columns)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>concatenated_data <span class="op">=</span> pd.concat([pivot_domestic_2010, pivot_domestic_2017], axis<span class="op">=</span><span class="dv">1</span>, keys<span class="op">=</span>[<span class="st">&#39;2010&#39;</span>, <span class="st">&#39;2017&#39;</span>])</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> concatenated_data.corr()</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap using seaborn</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2g&quot;</span>)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot which also displays pearsons correlation</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Correlation Matrix for Fuel Types in Domestic Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/8a3064c835fc949a7b64ef17a16ac5715d1ee8e5.png" /></p>
</div>
</div>
<div id="364fcd63" class="cell markdown">
<p>Specific correlations which stand out are; 2010 oil and 2017 oil, and
2010 oil and 2017 coal</p>
</div>
<div id="301b41ef" class="cell code" data-execution_count="937">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage change heatmap for domestic</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>domestic_table_data <span class="op">=</span> filtered_data_domestic_boroughs_Nottotal_2010_2017.pivot_table(values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;Fuel&#39;</span>], columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage change</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>domestic_table_data[<span class="st">&#39;Percentage Change&#39;</span>] <span class="op">=</span> ((domestic_table_data[<span class="dv">2017</span>] <span class="op">-</span> domestic_table_data[<span class="dv">2010</span>]) <span class="op">/</span> domestic_table_data[<span class="dv">2010</span>] <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap using sns</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>sns.heatmap(domestic_table_data[<span class="st">&#39;Percentage Change&#39;</span>].unstack(),annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Percentage Change in KtCO2e for Domestic Fuel Types (2010 to 2017)&quot;</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Year&quot;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/a2664af4a47b359da276ec02f10c4f55bf31638d.png" /></p>
</div>
</div>
<div id="b7a73f05" class="cell markdown">
<p>From the percentage change graph majority of the fuel types have
decreased it seems that electricity has had the biggest decrease.
Moreoeverusage of coal for domestic use seems to have increase. London
City coal usage is almost neglible in 2010 it was reported 0 and in 2017
it was reported as 0.0017292, hence its an empty cell</p>
</div>
<div id="befc5b94" class="cell code" data-execution_count="960">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparison on map</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the shapefile</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference: https://data.london.gov.uk/dataset/statistical-gis-boundary-files-london</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="st">&#39;statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&#39;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>map_df <span class="op">=</span> gpd.read_file(fp)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2010 and &#39;Domestic&#39; sector</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>co2_2010_domestic <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Domestic&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">#low to high</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2017 and &#39;Domestic&#39; sector</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>co2_2017_domestic <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Domestic&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the &#39;Domestic&#39; DataFrames with the GeoDataFrame for 2010 and 2017</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>merged_2010_domestic <span class="op">=</span> map_df.merge(co2_2010_domestic, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>merged_2017_domestic <span class="op">=</span> map_df.merge(co2_2017_domestic, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">8</span>))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Domestic&#39; CO2 emissions for 2010</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Using ax[i] to plot different axis</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">&#39;Domestic CO2 Emissions (Total) in 2010&#39;</span>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>merged_2010_domestic.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">0</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_axis_off()</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the map with borough names for 2010</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2010_domestic.geometry.centroid.x, merged_2010_domestic.geometry.centroid.y, merged_2010_domestic[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Domestic&#39; CO2 emissions for 2017</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">&#39;Domestic CO2 Emissions (Total) in 2017&#39;</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>merged_2017_domestic.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">1</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_axis_off()</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the map with borough names for 2017</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2017_domestic.geometry.centroid.x, merged_2017_domestic.geometry.centroid.y, merged_2017_domestic[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/15963e323a2324f5c09dbe45db91788720dfaa11.png" /></p>
</div>
</div>
<div id="4b0ce36c" class="cell markdown">
<p>3.2 Industrial &amp; Commercial</p>
</div>
<div id="af846937" class="cell code" data-execution_count="941">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Line graph</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Looking at the trend between 2010 and 2017 for industrial sector </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010 and 2017</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal_2010_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, style<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, style_order<span class="op">=</span>[<span class="dv">2010</span>, <span class="dv">2017</span>], data<span class="op">=</span>filtered_data_industrial_commercial_boroughs_Nottotal_2010_2017)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot; Fuel Type Contribution to Total KtCO2e in industrial &amp; commercial Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Total KtCO2e)&quot;</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better visibility</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/06ea85a6a018d72247fc22be1a19636fa4cd77e6.png" /></p>
</div>
</div>
<div id="de3f3763" class="cell code" data-execution_count="942">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Log line graph</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010 and 2017, Industrial and Commercial sector</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_2010_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set y-axis to logarithmic scale</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.lineplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, style<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, style_order<span class="op">=</span>[<span class="dv">2010</span>, <span class="dv">2017</span>], data<span class="op">=</span>filtered_data_industrial_commercial_2010_2017)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Taking Logs</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">&#39;log&#39;</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Fuel Type Contribution to Total KtCO2e in Industrial and Commercial Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Total KtCO2e&quot;</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better visibility</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/6729f478d989c87cf49b110734689b6b1b6dd101.png" /></p>
</div>
</div>
<div id="2bfa0723" class="cell code" data-execution_count="943">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix between 2010 and 2017</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010, Industrial and Commercial sector, excluding &#39;London&#39;, and &#39;Fuel&#39; not equal to &#39;Total&#39;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal_2010 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>  (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame to have fuel types as columns for 2010 in the Industrial and Commercial sector</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>pivot_industrial_commercial_2010 <span class="op">=</span> filtered_data_industrial_commercial_boroughs_Nottotal_2010.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2017, Industrial and Commercial sector, excluding &#39;London&#39;, and &#39;Fuel&#39; not equal to &#39;Total&#39;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>filtered_data_industrial_commercial_boroughs_Nottotal_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame to have fuel types as columns for 2017 in the Industrial and Commercial sector</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>pivot_industrial_commercial_2017 <span class="op">=</span> filtered_data_industrial_commercial_boroughs_Nottotal_2017.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the two DataFrames along a new axis</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>concatenated_industrial_commercial_data <span class="op">=</span> pd.concat([pivot_industrial_commercial_2010, pivot_industrial_commercial_2017],axis<span class="op">=</span><span class="dv">1</span>,keys<span class="op">=</span>[<span class="st">&#39;2010&#39;</span>, <span class="st">&#39;2017&#39;</span>])</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix for the Industrial and Commercial sector</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>correlation_matrix_industrial_commercial <span class="op">=</span> concatenated_industrial_commercial_data.corr()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">#heatmap using seaborn for the Industrial and Commercial sector</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_industrial_commercial, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2g&quot;</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Correlation Matrix for Fuel Types in Industrial and Commercial Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/2025f3d1e3a6025e94127ee6d48098edc0a52f8c.png" /></p>
</div>
</div>
<div id="1ea37794" class="cell code" data-execution_count="962">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage change heatmap</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pivot table for the Transport sector</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>table_data_industrial_commercial <span class="op">=</span> filtered_data_industrial_commercial_boroughs_Nottotal_2010_2017.pivot_table( values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;Fuel&#39;</span>], columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage change</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>table_data_industrial_commercial[<span class="st">&#39;Percentage Change&#39;</span>] <span class="op">=</span> ((table_data_industrial_commercial[<span class="dv">2017</span>] <span class="op">-</span> table_data_industrial_commercial[<span class="dv">2010</span>]) <span class="op">/</span> table_data_industrial_commercial[<span class="dv">2010</span>] <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap for the Transport sector</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(table_data_industrial_commercial[<span class="st">&#39;Percentage Change&#39;</span>].unstack(),annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Percentage Change in KtCO2e for industrial and commercial Fuel Types (2010 to 2017)&quot;</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Year&quot;</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/c715a69eb0eb9eb909d368d014f46976d9a5e894.png" /></p>
</div>
</div>
<div id="89079add" class="cell code" data-execution_count="963">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Chlorpleth map</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2010 and &#39;Industrial and Commercial&#39; sector</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>co2_2010_industrial_commercial <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2017 and &#39;Industrial and Commercial&#39; sector</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>co2_2017_industrial_commercial <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Industrial and Commercial&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>merged_2010_industrial_commercial <span class="op">=</span> map_df.merge(co2_2010_industrial_commercial, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>merged_2017_industrial_commercial <span class="op">=</span> map_df.merge(co2_2017_industrial_commercial, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot subplots</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">8</span>))</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Industrial and Commercial&#39; CO2 emissions for 2010</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">&#39;Industrial and Commercial CO2 Emissions (Total) in 2010&#39;</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>merged_2010_industrial_commercial.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">0</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_axis_off()</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2010 map annotations</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2010_industrial_commercial.geometry.centroid.x, merged_2010_industrial_commercial.geometry.centroid.y, merged_2010_industrial_commercial[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Industrial and Commercial&#39; CO2 emissions for 2017</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">&#39;Industrial and Commercial CO2 Emissions (Total) in 2017&#39;</span>)</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>merged_2017_industrial_commercial.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">1</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_axis_off()</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 2017 map annotations</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2017_industrial_commercial.geometry.centroid.x, merged_2017_industrial_commercial.geometry.centroid.y, merged_2017_industrial_commercial[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/d810e97d30f4d96272ef0229732ce029dc3e1a84.png" /></p>
</div>
</div>
<div id="8b563565" class="cell markdown">
<p>3.3 Transport</p>
</div>
<div id="935b0d38" class="cell code" data-execution_count="948">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Line graph showing fuel contribution</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2010 and 2017, Transport sector, excluding &#39;London&#39;, and &#39;Fuel&#39; not equal to &#39;Total&#39;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal_2010_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, style<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, style_order<span class="op">=</span>[<span class="dv">2010</span>, <span class="dv">2017</span>], data<span class="op">=</span>filtered_data_transport_boroughs_Nottotal_2010_2017)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Fuel Type Contribution to Total KtCO2e in Transport Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Total KtCO2e&quot;</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/569972c478c55a44863a35c401f28e94f28ffa8b.png" /></p>
</div>
</div>
<div id="dc525c55" class="cell code" data-execution_count="949">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix between 2010 and 2017</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal_2010 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for 2017, Transport sector, excluding &#39;London&#39;, and &#39;Fuel&#39; not equal to &#39;Total&#39;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>filtered_data_transport_boroughs_Nottotal_2017 <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">!=</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame to have fuel types as columns for 2010 in the Transport sector</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>pivot_transport_2010 <span class="op">=</span> filtered_data_transport_boroughs_Nottotal_2010.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame to have fuel types as columns for 2017 in the Transport sector</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>pivot_transport_2017 <span class="op">=</span> filtered_data_transport_boroughs_Nottotal_2017.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Fuel&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the two DataFrames along a new axis (columns)</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>concatenated_transport_data <span class="op">=</span> pd.concat([pivot_transport_2010, pivot_transport_2017], axis<span class="op">=</span><span class="dv">1</span>, keys<span class="op">=</span>[<span class="st">&#39;2010&#39;</span>, <span class="st">&#39;2017&#39;</span>])</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix for the Transport sector</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>correlation_matrix_transport <span class="op">=</span> concatenated_transport_data.corr()</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap using seaborn for the Transport sector</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_transport, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2g&quot;</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Correlation Matrix for Fuel Types in Transport Sector (2010 and 2017)&quot;</span>)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/7694f97169558edb1a87aa072f7d29eeac7fb61c.png" /></p>
</div>
</div>
<div id="50952d58" class="cell code" data-execution_count="950">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Percentage changes</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#filtering nessesary columns</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>table_data_transport <span class="op">=</span> filtered_data_transport_boroughs_Nottotal_2010_2017.pivot_table(values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;Fuel&#39;</span>], columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage change</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>table_data_transport[<span class="st">&#39;Percentage Change&#39;</span>] <span class="op">=</span> ((table_data_transport[<span class="dv">2017</span>] <span class="op">-</span> table_data_transport[<span class="dv">2010</span>]) <span class="op">/</span> table_data_transport[<span class="dv">2010</span>] <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap for the Transport sector</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(table_data_transport[<span class="st">&#39;Percentage Change&#39;</span>].unstack(),annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Percentage Change in KtCO2e for Transport Fuel Types (2010 to 2017)&quot;</span>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Year&quot;</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Borough&quot;</span>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/7b340cbacb4a718bf7a5e2424ba1cd5b0e93db21.png" /></p>
</div>
</div>
<div id="42b3ce9b" class="cell code" data-execution_count="953">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Chloropleth map for emissions transport sector</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2010 and &#39;Transport&#39; sector</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>co2_2010_transport <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter CO2 emissions for the year 2017 and &#39;Transport&#39; sector</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>co2_2017_transport <span class="op">=</span> data_emissions_copy[(data_emissions_copy[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Transport&#39;</span>) <span class="op">&amp;</span> (data_emissions_copy[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the &#39;Transport&#39; DataFrames with the GeoDataFrame for 2010 and 2017</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>merged_2010_transport <span class="op">=</span> map_df.merge(co2_2010_transport, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>merged_2017_transport <span class="op">=</span> map_df.merge(co2_2017_transport, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">8</span>))</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Transport&#39; CO2 emissions for 2010</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">&#39;Transport CO2 Emissions (Total) in 2010&#39;</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>merged_2010_transport.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">0</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_axis_off()</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the map with borough names for 2010</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2010_transport.geometry.centroid.x, merged_2010_transport.geometry.centroid.y, merged_2010_transport[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot &#39;Transport&#39; CO2 emissions for 2017</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">&#39;Transport CO2 Emissions (Total) in 2017&#39;</span>)</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>merged_2017_transport.plot(column<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>axs[<span class="dv">1</span>], edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_axis_off()</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the map with borough names for 2017</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_2017_transport.geometry.centroid.x, merged_2017_transport.geometry.centroid.y, merged_2017_transport[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/2524ee5fde43cae82fc4ee7ad89835a4b238eb16.png" /></p>
</div>
</div>
<div id="54ad7517" class="cell markdown">
<ol>
<li>Analytical Question</li>
</ol>
</div>
<div id="c04a4338" class="cell markdown">
<p>4.1 Domestic Vs Industrial</p>
</div>
<div id="13cf5640" class="cell code" data-execution_count="954">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bar plot comparison of sector between 2010 and 2017</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> data_emissions_population[(data_emissions_population[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Sector&#39;</span>].isin([<span class="st">&#39;Domestic&#39;</span>, <span class="st">&#39;Industrial and Commercial&#39;</span>])) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping variables needed</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> filtered_data.groupby([<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;LEGGI_Year&#39;</span>, <span class="st">&#39;Sector&#39;</span>])[<span class="st">&#39;KtCO2e&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create separate bar plots for 2010 and 2017</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">8</span>))</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for 2010</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Subplots</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Sector&#39;</span>, data<span class="op">=</span>grouped_data[grouped_data[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>], ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;2010&#39;</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Borough&#39;</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total KtCO2e&#39;</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Sector&#39;</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for 2017</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Sector&#39;</span>, data<span class="op">=</span>grouped_data[grouped_data[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>], ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;2017&#39;</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Borough&#39;</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total KtCO2e&#39;</span>)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Sector&#39;</span>)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/ed6ba3e6230e5f8e4e231501361777d4ea135793.png" /></p>
</div>
</div>
<div id="24c981e4" class="cell markdown">
<p>4.2 Domestic Vs Transport</p>
</div>
<div id="01a37cab" class="cell code" data-execution_count="955">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bar plot comparison of sector</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> data_emissions_population[(data_emissions_population[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Sector&#39;</span>].isin([<span class="st">&#39;Domestic&#39;</span>, <span class="st">&#39;Transport&#39;</span>])) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span>(data_emissions_population[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating grouped data using variables required</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> filtered_data.groupby([<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;LEGGI_Year&#39;</span>, <span class="st">&#39;Sector&#39;</span>])[<span class="st">&#39;KtCO2e&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">8</span>))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for 2010</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating subplots</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Sector&#39;</span>, data<span class="op">=</span>grouped_data[grouped_data[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2010</span>], ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;2010&#39;</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Borough&#39;</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total KtCO2e&#39;</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Sector&#39;</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for 2017</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Sector&#39;</span>, data<span class="op">=</span>grouped_data[grouped_data[<span class="st">&#39;LEGGI_Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>], ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;2017&#39;</span>)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Borough&#39;</span>)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total KtCO2e&#39;</span>)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Sector&#39;</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/f3dddfe9c9c3d1d37e406adf54d682f14b50eec6.png" /></p>
</div>
</div>
<div id="c13dfaa3" class="cell markdown">
<p>4.3 Population vs Co2</p>
</div>
<div id="d6eb1eaf" class="cell code" data-execution_count="965">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage change chloropleth map</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude &#39;London&#39; borough and filter for &#39;Total&#39; sector</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> data_emissions_population[</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    (data_emissions_population[<span class="st">&#39;Borough&#39;</span>] <span class="op">!=</span> <span class="st">&#39;London&#39;</span>) <span class="op">&amp;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    (data_emissions_population[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>) <span class="op">&amp;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    (data_emissions_population[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>]))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create pivot tables for percentage change</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>pivot_population <span class="op">=</span> filtered_data.pivot_table(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>],</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">&#39;Population&#39;</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>pivot_emissions <span class="op">=</span> filtered_data.pivot_table(</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>],</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>,</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change for population</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>pivot_population[<span class="st">&#39;Percentage_Change_Population&#39;</span>] <span class="op">=</span> (</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    (pivot_population[<span class="dv">2017</span>] <span class="op">-</span> pivot_population[<span class="dv">2010</span>]) <span class="op">/</span> pivot_population[<span class="dv">2010</span>]</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change for total emissions</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>pivot_emissions[<span class="st">&#39;Percentage_Change_Emissions&#39;</span>] <span class="op">=</span> (</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    (pivot_emissions[<span class="dv">2017</span>] <span class="op">-</span> pivot_emissions[<span class="dv">2010</span>]) <span class="op">/</span> pivot_emissions[<span class="dv">2010</span>]</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shapefile for London boroughs</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="st">&#39;statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&#39;</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>boroughs_shapefile <span class="op">=</span> gpd.read_file(fp)</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the GeoDataFrame with the filtered data</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>merged_population <span class="op">=</span> boroughs_shapefile.merge(pivot_population, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_index<span class="op">=</span><span class="va">True</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>merged_emissions <span class="op">=</span> boroughs_shapefile.merge(pivot_emissions, left_on<span class="op">=</span><span class="st">&#39;NAME&#39;</span>, right_index<span class="op">=</span><span class="va">True</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">24</span>, <span class="dv">10</span>))</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the choropleth map for Percentage Change in Population</span></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> merged_population.plot(column<span class="op">=</span><span class="st">&#39;Percentage_Change_Population&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Percentage Change in Population (2010-2017) by London Borough (Excluding London)&#39;</span>)</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>ax1.set_axis_off()</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_population.geometry.centroid.x, merged_population.geometry.centroid.y, merged_population[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>    ax1.text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the choropleth map for Percentage Change in Total Emissions</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> merged_emissions.plot(column<span class="op">=</span><span class="st">&#39;Percentage_Change_Emissions&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;OrRd_r&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, edgecolor<span class="op">=</span><span class="st">&#39;0.8&#39;</span>, legend<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Percentage Change in Total CO2 Emissions (2010-2017) by London Borough (Excluding London)&#39;</span>)</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>ax2.set_axis_off()</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, label <span class="kw">in</span> <span class="bu">zip</span>(merged_emissions.geometry.centroid.x, merged_emissions.geometry.centroid.y, merged_emissions[<span class="st">&#39;NAME&#39;</span>]):</span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>    ax2.text(x, y, label, fontsize<span class="op">=</span><span class="dv">8</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>))</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/b550f8f1e0db32ddf578dc8e43f04eb92fc4c0f8.png" /></p>
</div>
</div>
<div id="1e6a2c0d" class="cell code" data-execution_count="961">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting heatmap of percentage change per sector</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the years 2010 and 2017 and where &#39;Fuel&#39; is &#39;Total&#39;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>data_population_change <span class="op">=</span> data_emissions_population[(data_emissions_population[<span class="st">&#39;LEGGI_Year&#39;</span>].isin([<span class="dv">2010</span>, <span class="dv">2017</span>])) <span class="op">&amp;</span> (data_emissions_population[<span class="st">&#39;Fuel&#39;</span>] <span class="op">==</span> <span class="st">&#39;Total&#39;</span>)]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pivot table for population change</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>pivot_population_change <span class="op">=</span> data_population_change.pivot_table(index<span class="op">=</span><span class="st">&#39;Borough&#39;</span>, columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>,values<span class="op">=</span><span class="st">&#39;Population&#39;</span>,aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change for population</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>pivot_population_change[<span class="st">&#39;Percentage_Change_Population&#39;</span>] <span class="op">=</span> ((pivot_population_change[<span class="dv">2017</span>] <span class="op">-</span> pivot_population_change[<span class="dv">2010</span>]) <span class="op">/</span> pivot_population_change[<span class="dv">2010</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pivot table for emissions change by sector</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>pivot_emissions_change <span class="op">=</span> data_emissions_population.pivot_table(index<span class="op">=</span>[<span class="st">&#39;Borough&#39;</span>, <span class="st">&#39;Sector&#39;</span>],columns<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>,aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating percentage change </span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>pivot_emissions_change[<span class="st">&#39;Percentage_Change_Emissions&#39;</span>] <span class="op">=</span> ((pivot_emissions_change[<span class="dv">2017</span>] <span class="op">-</span> pivot_emissions_change[<span class="dv">2010</span>]) <span class="op">/</span> pivot_emissions_change[<span class="dv">2010</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the sectors to plot based on the unique values in the &#39;Sector&#39; column</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>sectors_to_plot <span class="op">=</span> unique_sectors</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for specific sectors</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>filtered_emissions_change <span class="op">=</span> pivot_emissions_change[pivot_emissions_change.index.get_level_values(<span class="st">&#39;Sector&#39;</span>).isin(sectors_to_plot)]</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>filtered_emissions_change <span class="op">=</span> filtered_emissions_change.unstack(level<span class="op">=</span><span class="st">&#39;Sector&#39;</span>)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the population and emissions DataFrames</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>combined_data <span class="op">=</span> pd.concat([pivot_population_change[[<span class="st">&#39;Percentage_Change_Population&#39;</span>]], filtered_emissions_change[<span class="st">&#39;Percentage_Change_Emissions&#39;</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap table using seaborn</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>sns.heatmap(combined_data,annot<span class="op">=</span><span class="va">True</span>,cmap<span class="op">=</span><span class="st">&#39;cividis&#39;</span>,fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>,linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Percentage Change in Population and Emissions (2010-2017) by Borough and Sector&#39;</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/530b0b7232a3f84378792f3ef73ebe42fceb8224.png" /></p>
</div>
</div>
<div id="2f562594" class="cell markdown">
<p>Predictions</p>
</div>
<div id="b0e28968" class="cell code" data-execution_count="966">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Regression</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Table the sectors for for loop </span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Refernce: https://stackoverflow.com/questions/74905764/in-python-is-there-a-way-to-use-a-for-loop-to-perform-a-linear-regression-multi</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>sectors <span class="op">=</span> [<span class="st">&#39;Transport&#39;</span>, <span class="st">&#39;Domestic&#39;</span>, <span class="st">&#39;Industrial and Commercial&#39;</span>]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>, <span class="st">&#39;blue&#39;</span>]</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subplots for each sector side by side</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Reference: https://stackoverflow.com/questions/50439431/difference-between-sharey-row-and-sharey-true</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="bu">len</span>(sectors), figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>),sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each sector</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (sector, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(sectors, colors)):</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting line graph for the sector with assigned color - Emissions</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>,y<span class="op">=</span><span class="st">&#39;KtCO2e&#39;</span>, data<span class="op">=</span>filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector],label<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>sector<span class="sc">}</span><span class="ss"> Emissions&#39;</span>,ax<span class="op">=</span>axes[i],color<span class="op">=</span>color  )</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a second y-axis to plot population data - Emissions</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> axes[i].twinx()</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(x<span class="op">=</span><span class="st">&#39;LEGGI_Year&#39;</span>, y<span class="op">=</span><span class="st">&#39;Population&#39;</span>, data<span class="op">=</span>filtered_data_london_sectors_2010_2017, label<span class="op">=</span><span class="st">&#39;Population&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the linear regression model for Emissions </span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    X_emissions <span class="op">=</span> filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector][[<span class="st">&#39;LEGGI_Year&#39;</span>]]</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    y_emissions <span class="op">=</span> filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector][<span class="st">&#39;KtCO2e&#39;</span>]</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    model_emissions <span class="op">=</span> LinearRegression()</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Reference:https://realpython.com/linear-regression-in-python/</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    model_emissions.fit(X_emissions, y_emissions)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict emissions for future years</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    future_years <span class="op">=</span> pd.DataFrame({<span class="st">&#39;LEGGI_Year&#39;</span>: <span class="bu">range</span>(<span class="dv">2010</span>, <span class="dv">2031</span>)})</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>    future_predictions_emissions <span class="op">=</span> model_emissions.predict(future_years[[<span class="st">&#39;LEGGI_Year&#39;</span>]])</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the regression line for emissions</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>    axes[i].plot(future_years[<span class="st">&#39;LEGGI_Year&#39;</span>], future_predictions_emissions, linestyle<span class="op">=</span><span class="st">&#39;dashed&#39;</span>, label<span class="op">=</span><span class="st">&#39;Predicted Emissions&#39;</span>, color<span class="op">=</span>color)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    axes[i].legend(loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the linear regression model for Population</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>    X_population <span class="op">=</span> filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector][[<span class="st">&#39;LEGGI_Year&#39;</span>]]</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    y_population <span class="op">=</span> filtered_data_london_sectors_2010_2017[filtered_data_london_sectors_2010_2017[<span class="st">&#39;Sector&#39;</span>] <span class="op">==</span> sector][<span class="st">&#39;Population&#39;</span>]</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>    model_population <span class="op">=</span> LinearRegression()</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>    model_population.fit(X_population, y_population)</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict population for future years</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>    future_predictions_population <span class="op">=</span> model_population.predict(future_years[[<span class="st">&#39;LEGGI_Year&#39;</span>]])</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the regression line for population</span></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>    ax2.plot(future_years[<span class="st">&#39;LEGGI_Year&#39;</span>], future_predictions_population, linestyle<span class="op">=</span><span class="st">&#39;dashed&#39;</span>, label<span class="op">=</span><span class="st">&#39;Predicted Population&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>)</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9be63814d8604528957cbe548ec5b924/07c5afd61a02674d60dc207eec4b1695fa707881.png" /></p>
</div>
</div>
<div id="f1257f9d" class="cell code">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
